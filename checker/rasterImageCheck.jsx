// 埋め込み画像を調べる//// return  { result: Boolean (true is success)//           message: "hello..." (some text) }function rasterImageCheck() {  var doc = app.activeDocument  var rasters = doc.rasterItems  var result = true  var message = []  var embed = false  for (var i = 0; i < rasters.length; i++) {    if (rasters[i].embedded) {      var nm = rasters[i].name      if (nm == '') {        try {          nm = rasters[i].file.name        } catch (e) {          nm = 'undefind'        }      }      embed = true      if (rasters[i].imageColorSpace == ImageColorSpace.CMYK) {        message.push('埋込 CMYK 画像 : ' + nm)      } else if (rasters[i].imageColorSpace == ImageColorSpace.RGB) {        message.push('埋込 RGB 画像 : ' + nm)      }    }  }  if (embed == false) {    message[0] = '埋込み画像データはありません'    result = true  }  return { result: result, message: message }}